<?xml version="1.0" encoding="EUC-JP"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja">

<head>
<meta charset="UTF-8">
<title>SoraMame Script</title>
<script type="text/javascript" src="parse.js"></script>
<script type="text/javascript" src="soramame.js"></script>
</head>


<body>
<h1>日本語っぽいプログラミング言語：SoraMame Script(そら豆スクリプト)</h1>
入力した日本語っぽいコードを、ビジュアルデザイン用のプログラミング言語Processing.jsに変換して実行します(SoraMame.ps.js)。
<hr />
<textarea id="source" cols="80" rows="20">
1000
文字列a
「あいうえお」
</textarea><br />
<input type="button" value="字句解析" onclick="soramame_lex()" />
<input type="button" value="構文解析" onclick="soramame_parse()" />
<input type="button" value="実行" onclick="soramame_exec()" />
<h2>結果</h2>
<pre id="screen"></pre>
</body>


</html>


<script type="text/javascript">
<!--
var sora;
var yylval = '';
var variables = {};


function soramame_exec(){
  var Esource = document.getElementById("source");
  sora = new soramame(Esource.value);

  yyparse();
}


function soramame_lex(){
  var Esource = document.getElementById("source");
  sora = new soramame(Esource.value);

  var type;
  var retval;
  var i = 0;
  while(retval = yylex()){
    switch(retval){
	case COMMENT:
      type = "COMMENT";
      break;
    case NUMBER:
      type = "NUMBER";
      break;
    case STRING:
      type = "STRING";
      break;
    case JOSI:
      type = "JOSI";
      break;
    case WORD:
      type = "WORD";
      break;
    default:
      type = retval;
      break;
    }
    sora.debug(type+": "+yylval);
    if(i++ > 100){
      break;
    }
  }
}


function yylex(){
  var retval = sora.yylex();
  yylval = sora.yylval;
  return retval;
}


function yyerror(str){
  sora.debug(str);
}

function soramame_parse(){

  var Esource = document.getElementById("source");
  sora = new soramame(Esource.value);
  //sora.debug("parse now!");
  var script = yyparse();
  sora.debug(script);
  
  //yyyBuffer = document.getElementById("source");
  //var script = yyparse();
  //sora.debug(script);

  //var Esource = document.getElementById("source");  
  //sora = new soramame(Esource.value);
  //sora.debug(Esource.value);
}
//-->
</script>
